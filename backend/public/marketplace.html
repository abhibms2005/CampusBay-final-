<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CampusBay - Marketplace</title>

    <!-- Google Fonts - Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Favicon -->
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üéì</text></svg>">

    <style>
        /* ===================================
           PRELOADER FOR "100% EFFICIENT" FEEL
           =================================== */
        #preloader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0f172a;
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }

        .loader {
            width: 48px;
            height: 48px;
            border: 5px solid #FFF;
            border-bottom-color: #6366f1;
            border-radius: 50%;
            display: inline-block;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
        }

        @keyframes rotation {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        body.loaded #preloader {
            opacity: 0;
            visibility: hidden;
        }
    </style>

    <script>
        window.addEventListener('load', function () {
            setTimeout(() => {
                document.body.classList.add('loaded');
            }, 800);
        });
    </script>

    <!-- App Scripts -->

    <style>
        /* ===================================
    PREMIUM DESIGN SYSTEM FOUNDATION
    =================================== */

        :root {
            /* Primary Colors - Indigo */
            --primary-50: #EEF2FF;
            --primary-100: #E0E7FF;
            --primary-200: #C7D2FE;
            --primary-300: #A5B4FC;
            --primary-400: #818CF8;
            --primary-500: #6366F1;
            --primary-600: #4F46E5;
            --primary-700: #4338CA;
            --primary-800: #3730A3;
            --primary-900: #312E81;

            /* Accent Colors - Pink */
            --accent-50: #FDF2F8;
            --accent-100: #FCE7F3;
            --accent-200: #FBCFE8;
            --accent-300: #F9A8D4;
            --accent-400: #F472B6;
            --accent-500: #EC4899;
            --accent-600: #DB2777;
            --accent-700: #BE185D;
            --accent-800: #9D174D;
            --accent-900: #831843;

            /* Semantic Colors */
            --success-500: #10B981;
            --success-600: #059669;
            --warning-500: #F59E0B;
            --error-500: #EF4444;

            /* Neutral Grays */
            --gray-50: #F9FAFB;
            --gray-100: #F3F4F6;
            --gray-200: #E5E7EB;
            --gray-300: #D1D5DB;
            --gray-400: #9CA3AF;
            --gray-500: #6B7280;
            --gray-600: #4B5563;
            --gray-700: #374151;
            --gray-800: #1F2937;
            --gray-900: #111827;

            /* Background & Surface */
            --bg-primary: #FFFFFF;
            --bg-secondary: #F9FAFB;
            --bg-tertiary: #F3F4F6;

            /* Text Colors */
            --text-primary: #111827;
            --text-secondary: #6B7280;
            --text-tertiary: #9CA3AF;

            /* Shadows */
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
            --shadow-2xl: 0 25px 50px -12px rgb(0 0 0 / 0.25);

            /* Spacing Scale (8px base) */
            --space-1: 0.25rem;
            --space-2: 0.5rem;
            --space-3: 0.75rem;
            --space-4: 1rem;
            --space-5: 1.25rem;
            --space-6: 1.5rem;
            --space-8: 2rem;
            --space-10: 2.5rem;
            --space-12: 3rem;
            --space-16: 4rem;
            --space-20: 5rem;
            --space-24: 6rem;

            /* Border Radius */
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
            --radius-2xl: 1.5rem;
            --radius-full: 9999px;

            /* Layout */
            --header-height: 72px;
        }

        /* ===================================
    DARK MODE THEME - MODERN GLASSMORPHISM
    =================================== */

        [data-theme="dark"] {
            /* Glass Backgrounds */
            --bg-primary: rgba(30, 41, 59, 0.7);
            /* Frosted Dark Slate */
            --bg-secondary: rgba(15, 23, 42, 0.6);
            /* Deeper Frost */
            --bg-tertiary: rgba(51, 65, 85, 0.5);

            /* High Contrast Text */
            --text-primary: #FFFFFF;
            --text-secondary: #E2E8F0;
            --text-tertiary: #94A3B8;

            /* Glass Borders & Highlights */
            --glass-border: 1px solid rgba(255, 255, 255, 0.1);
            --glass-highlight: rgba(255, 255, 255, 0.05);

            /* Shadows & Glows */
            --shadow-sm: 0 0 0 1px rgba(255, 255, 255, 0.1), 0 2px 4px rgba(0, 0, 0, 0.4);
            --shadow-md: 0 0 0 1px rgba(255, 255, 255, 0.1), 0 8px 16px rgba(0, 0, 0, 0.5);
            --shadow-lg: 0 0 0 1px rgba(255, 255, 255, 0.1), 0 20px 40px rgba(0, 0, 0, 0.6);

            /* Grays mapped to Slate */
            --gray-50: rgba(30, 41, 59, 0.5);
            --gray-100: rgba(51, 65, 85, 0.5);
            --gray-200: #475569;
            --gray-800: #F8FAFC;
            --gray-900: #FFFFFF;
        }

        /* Smooth theme transitions */
        * {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
        }

        /* "AURORA" MESH GRADIENT BACKGROUND */
        [data-theme="dark"] body {
            background-color: #0f172a;
            background-image:
                radial-gradient(at 0% 0%, hsla(253, 16%, 7%, 1) 0, transparent 50%),
                radial-gradient(at 50% 0%, hsla(225, 39%, 30%, 1) 0, transparent 50%),
                radial-gradient(at 100% 0%, hsla(339, 49%, 30%, 1) 0, transparent 50%);
            background-attachment: fixed;
        }

        /* Floating Orbs Overlay */
        [data-theme="dark"] body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background:
                radial-gradient(circle at 15% 50%, rgba(124, 58, 237, 0.15), transparent 25%),
                radial-gradient(circle at 85% 30%, rgba(236, 72, 153, 0.15), transparent 25%);
            filter: blur(40px);
            z-index: -1;
            animation: pulse-glow 10s ease-in-out infinite alternate;
        }

        @keyframes pulse-glow {
            0% {
                opacity: 0.5;
                transform: scale(1);
            }

            100% {
                opacity: 0.8;
                transform: scale(1.1);
            }
        }

        /* ===================================
    DARK MODE COMPONENT OVERRIDES
    =================================== */

        /* Header: Frosted Glass Overlay */
        [data-theme="dark"] .header {
            background: linear-gradient(180deg, rgba(15, 23, 42, 0.8) 0%, rgba(15, 23, 42, 0.6) 100%);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            border-image: none;
            /* FIX: Remove rainbow border from light mode */
            backdrop-filter: blur(20px);
        }

        /* Dark mode scrolled header fix - prevents white background on scroll */
        [data-theme="dark"] .header.scrolled {
            background: linear-gradient(180deg, rgba(15, 23, 42, 0.95) 0%, rgba(15, 23, 42, 0.85) 100%);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.1);
        }

        /* Sidebar: Glass Panel */
        [data-theme="dark"] .filters {
            background: rgba(30, 41, 59, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        /* Listing Cards: Floating Glass */
        [data-theme="dark"] .listing-card {
            background: rgba(30, 41, 59, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            backdrop-filter: blur(8px);
        }

        [data-theme="dark"] .listing-card:hover {
            background: rgba(30, 41, 59, 0.6);
            border-color: rgba(99, 102, 241, 0.5);
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.3);
            transform: translateY(-8px);
        }

        /* Inputs: Dark Glass */
        [data-theme="dark"] .header-search input,
        [data-theme="dark"] .filter-group input {
            background: rgba(15, 23, 42, 0.6);
            border-color: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
        }

        [data-theme="dark"] .header-search input:focus,
        [data-theme="dark"] .filter-group input:focus {
            border-color: var(--primary-400);
            background: rgba(15, 23, 42, 0.8);
        }



        /* ===================================
    BASE STYLES
    =================================== */

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
            /* RICH ATMOSPHERIC BACKGROUND - NO MORE FLAT WHITE! */
            background: linear-gradient(135deg,
                    #f8f9ff 0%,
                    #fef4f8 25%,
                    #f9f9ff 50%,
                    #fff9f5 75%,
                    #f8f9ff 100%);
            background-attachment: fixed;
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            position: relative;
        }

        /* ===================================
    AESTHETIC SCROLLBAR (CHROME/SAFARI)
    =================================== */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(99, 102, 241, 0.3);
            border-radius: 99px;
            border: 2px solid transparent;
            background-clip: content-box;
            transition: background 0.3s ease;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(99, 102, 241, 0.6);
            border: 2px solid transparent;
            background-clip: content-box;
        }

        /* Dark Mode Scrollbar */
        [data-theme="dark"] ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
        }

        [data-theme="dark"] ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.4);
        }

        /* ATMOSPHERIC TEXTURE OVERLAY */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image:
                radial-gradient(circle at 20% 30%, rgba(99, 102, 241, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(236, 72, 153, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(99, 102, 241, 0.02) 0%, transparent 40%);
            pointer-events: none;
            z-index: 0;
        }

        /* ENSURE CONTENT APPEARS ABOVE BACKGROUND */
        .header,
        .container,
        .main-content,
        .footer {
            position: relative;
            z-index: 1;
        }

        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 var(--space-6);
        }

        /* ===================================
    HEADER / NAVIGATION - RICH & DISTINCTIVE
    =================================== */

        .header {
            background: linear-gradient(135deg,
                    rgba(255, 255, 255, 0.95) 0%,
                    rgba(248, 249, 255, 0.9) 50%,
                    rgba(254, 244, 248, 0.9) 100%);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 2px solid;
            border-image: linear-gradient(90deg,
                    var(--primary-300),
                    var(--accent-300),
                    var(--primary-300)) 1;
            padding: var(--space-4) var(--space-6);
            height: var(--header-height);
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 999;
            transition: all 0.3s ease;
            box-shadow:
                var(--shadow-md),
                0 4px 20px rgba(99, 102, 241, 0.08);
        }

        /* SUBTLE PATTERN OVERLAY ON HEADER */
        .header::before {
            content: '';
            position: absolute;
            inset: 0;
            background-image:
                radial-gradient(circle at 15% 50%, rgba(99, 102, 241, 0.03) 0%, transparent 30%),
                radial-gradient(circle at 85% 50%, rgba(236, 72, 153, 0.03) 0%, transparent 30%);
            pointer-events: none;
        }

        .header.scrolled {
            box-shadow:
                var(--shadow-lg),
                0 8px 30px rgba(99, 102, 241, 0.12);
            background: linear-gradient(135deg,
                    rgba(255, 255, 255, 0.98) 0%,
                    rgba(248, 249, 255, 0.95) 50%,
                    rgba(254, 244, 248, 0.95) 100%);
        }

        .header-logo {
            font-size: 1.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary-600), var(--accent-500));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: var(--space-2);
            transition: transform 0.2s ease;
        }

        .header-logo:hover {
            transform: scale(1.02);
        }

        .header-logo::before {
            content: "üéì";
            font-size: 1.75rem;
            filter: grayscale(0);
        }

        .header-search {
            flex-grow: 1;
            margin: 0 var(--space-8);
            max-width: 600px;
        }

        .header-search input {
            width: 100%;
            padding: var(--space-3) var(--space-5);
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-full);
            font-size: 0.9375rem;
            font-family: inherit;
            transition: all 0.3s ease;
            background: var(--bg-primary);
        }

        .header-search input:focus {
            outline: none;
            border-color: var(--primary-400);
            box-shadow: 0 0 0 4px var(--primary-50);
        }

        .header-search input::placeholder {
            color: var(--text-tertiary);
        }

        .header-nav {
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }

        /* Nav States */
        #nav-logged-in {
            display: none;
            align-items: center;
            gap: var(--space-3);
        }

        #nav-logged-out {
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }

        #welcome-msg {
            font-size: 0.9375rem;
            font-weight: 600;
            color: var(--text-primary);
            white-space: nowrap;
        }

        /* ===================================
    BUTTON SYSTEM
    =================================== */

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-2);
            font-size: 0.9375rem;
            font-weight: 600;
            padding: var(--space-3) var(--space-6);
            border-radius: var(--radius-full);
            border: none;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-family: inherit;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-600), var(--primary-700));
            color: white;
            box-shadow: 0 4px 14px 0 rgba(79, 70, 229, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px 0 rgba(79, 70, 229, 0.5);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background-color: var(--bg-primary);
            color: var(--primary-700);
            border: 2px solid var(--primary-200);
        }

        .btn-secondary:hover {
            background-color: var(--primary-50);
            border-color: var(--primary-300);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success-500), var(--success-600));
            color: white;
            cursor: default;
        }

        .btn-danger {
            background-color: var(--error-500);
            color: white;
        }

        .btn-danger:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }

        .btn-demo {
            background: linear-gradient(135deg, var(--success-500), var(--success-600));
            color: white;
            border: none;
            width: 100%;
            padding: var(--space-4);
            font-size: 1rem;
            border-radius: var(--radius-lg);
            cursor: pointer;
            margin-top: var(--space-4);
            font-weight: 600;
            box-shadow: 0 4px 14px 0 rgba(16, 185, 129, 0.3);
        }

        .btn-demo:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px 0 rgba(16, 185, 129, 0.4);
        }


        /* ===================================
    MAIN CONTENT LAYOUT
    =================================== */

        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: var(--space-8);
            padding: var(--space-8) 0;
            position: relative;
        }

        /* DECORATIVE DIVIDER BETWEEN COLUMNS */
        .main-content::before {
            content: '';
            position: absolute;
            left: 320px;
            top: var(--space-8);
            bottom: var(--space-8);
            width: 2px;
            background: linear-gradient(180deg,
                    transparent 0%,
                    var(--primary-200) 10%,
                    var(--accent-200) 50%,
                    var(--primary-200) 90%,
                    transparent 100%);
            opacity: 0.5;
        }

        /* ===================================
    FILTERS SIDEBAR - PROFESSIONAL CONTROL PANEL
    =================================== */

        /* ===================================
           PROFESSIONAL SIDEBAR CONTROLS
           =================================== */
        .filters {
            background: var(--bg-secondary);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: var(--space-6);
            border-radius: var(--radius-2xl);
            /* STICKY SIDEBAR FIX */
            height: fit-content;
            max-height: calc(100vh - 120px);
            overflow-y: auto;
            position: sticky;
            top: calc(var(--header-height) + var(--space-6));
            border: 2px solid var(--gray-200);
            box-shadow: var(--shadow-xl);
            /* Custom Scrollbar for Sidebar */
            scrollbar-width: thin;
        }

        /* VISUAL HEADER FOR FILTERS */
        .filters::before {
            content: 'üéØ Filters';
            display: block;
            font-size: 1.25rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary-700), var(--accent-600));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: var(--space-6);
            padding-bottom: var(--space-4);
            border-bottom: 3px solid;
            border-image: linear-gradient(90deg, var(--primary-500), var(--accent-500)) 1;
        }

        .filter-group {
            margin-bottom: var(--space-6);
            padding-bottom: var(--space-6);
            border-bottom: 2px solid rgba(255, 255, 255, 0.5);
            position: relative;
        }

        .filter-group:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        /* PROFESSIONAL SECTION HEADERS */
        .filter-group h3 {
            font-size: 1.125rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: var(--space-4);
            letter-spacing: -0.01em;
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .filter-group h3::before {
            content: '‚óè';
            color: var(--primary-600);
            font-size: 0.75rem;
        }

        .filter-group label {
            display: flex;
            align-items: center;
            margin-bottom: var(--space-3);
            font-size: 0.9375rem;
            cursor: pointer;
            color: var(--text-secondary);
            transition: color 0.2s ease;
        }

        .filter-group label:hover {
            color: var(--primary-700);
        }

        .filter-group input[type="checkbox"] {
            margin-right: var(--space-3);
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: var(--primary-600);
        }

        .filter-group input[type="text"],
        .filter-group input[type="number"] {
            width: 100%;
            padding: var(--space-3);
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-lg);
            margin-top: var(--space-2);
            font-family: inherit;
            font-size: 0.9375rem;
            transition: all 0.3s ease;
        }

        .filter-group input[type="text"]:focus,
        .filter-group input[type="number"]:focus {
            outline: none;
            border-color: var(--primary-400);
            box-shadow: 0 0 0 4px var(--primary-50);
        }

        .price-filter {
            display: flex;
            gap: var(--space-3);
            align-items: center;
        }

        .price-filter input {
            flex: 1;
            min-width: 0;
            /* Prevents flex items from overflowing */
        }

        /* ===================================
    LISTINGS GRID - BOLD & VIBRANT
    =================================== */

        /* SECTION HEADER ABOVE LISTINGS */
        .listings-grid::before {
            content: '‚ú® Available Items';
            display: block;
            font-size: 1.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary-700), var(--accent-600));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: var(--space-6);
            padding-bottom: var(--space-4);
            border-bottom: 3px solid;
            border-image: linear-gradient(90deg, var(--primary-500), var(--accent-500)) 1;
            grid-column: 1 / -1;
        }

        .listings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: var(--space-6);
            min-height: 400px;
        }

        .listing-card {
            position: relative;
            background: var(--bg-primary);
            backdrop-filter: blur(10px);
            border-radius: var(--radius-2xl);
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
            border: 2px solid var(--gray-200);
            cursor: pointer;
        }

        .listing-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--primary-500), var(--accent-500));
            opacity: 0;
            transition: opacity 0.4s ease;
            z-index: 0;
        }

        /* SMART BADGE ON CARDS */
        .listing-card::after {
            content: 'üî• Popular';
            position: absolute;
            top: var(--space-4);
            right: var(--space-4);
            background: linear-gradient(135deg, var(--accent-600), var(--accent-700));
            color: white;
            padding: var(--space-2) var(--space-4);
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 700;
            z-index: 10;
            box-shadow: var(--shadow-md);
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.3s ease;
        }

        /* Show badge on every 3rd card (popular items) */
        .listing-card:nth-child(3n)::after {
            opacity: 1;
            transform: scale(1);
        }

        /* Alternative badge for different cards */
        .listing-card:nth-child(5n)::after {
            content: 'üìç Near You';
            background: linear-gradient(135deg, var(--success-500), var(--success-600));
        }

        .listing-card:hover {
            transform: translateY(-14px) scale(1.03);
            box-shadow:
                var(--shadow-2xl),
                0 0 40px rgba(99, 102, 241, 0.2),
                0 0 0 3px rgba(99, 102, 241, 0.1);
            border-color: var(--primary-200);
        }

        .listing-card:hover::before {
            opacity: 0.09;
        }

        .listing-card-image {
            position: relative;
            z-index: 1;
            width: 100%;
            height: 200px;
            /* NO MORE BORING GRAY BACKGROUNDS! */
            background: linear-gradient(135deg,
                    rgba(99, 102, 241, 0.1),
                    rgba(236, 72, 153, 0.08),
                    rgba(99, 102, 241, 0.06));
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-tertiary);
            font-size: 0.875rem;
            text-align: center;
            padding: var(--space-4);
            overflow: hidden;
        }

        .listing-card-image::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(180deg, transparent 0%, rgba(0, 0, 0, 0.4) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .listing-card:hover .listing-card-image::after {
            opacity: 1;
        }

        .listing-card-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .listing-card:hover .listing-card-image img {
            transform: scale(1.1);
        }

        /* ===================================
    CATEGORY-SPECIFIC PLACEHOLDERS
    =================================== */

        .listing-card[data-category="Books"] .listing-card-image:not(:has(img)) {
            background: linear-gradient(135deg, #4338CA, #6366F1);
        }

        .listing-card[data-category="Books"] .listing-card-image:not(:has(img))::before {
            content: 'üìö';
            position: absolute;
            font-size: 4rem;
            opacity: 0.4;
            z-index: 0;
        }

        .listing-card[data-category="Electronics"] .listing-card-image:not(:has(img)) {
            background: linear-gradient(135deg, #0891B2, #06B6D4);
        }

        .listing-card[data-category="Electronics"] .listing-card-image:not(:has(img))::before {
            content: '‚ö°';
            position: absolute;
            font-size: 4rem;
            opacity: 0.4;
            z-index: 0;
        }

        .listing-card[data-category="Fashion"] .listing-card-image:not(:has(img)) {
            background: linear-gradient(135deg, #DB2777, #EC4899);
        }

        .listing-card[data-category="Fashion"] .listing-card-image:not(:has(img))::before {
            content: 'üëï';
            position: absolute;
            font-size: 4rem;
            opacity: 0.4;
            z-index: 0;
        }

        .listing-card[data-category="Furniture"] .listing-card-image:not(:has(img)) {
            background: linear-gradient(135deg, #92400E, #B45309);
        }

        .listing-card[data-category="Furniture"] .listing-card-image:not(:has(img))::before {
            content: 'ü™ë';
            position: absolute;
            font-size: 4rem;
            opacity: 0.4;
            z-index: 0;
        }

        .listing-card[data-category="Stationery"] .listing-card-image:not(:has(img)) {
            background: linear-gradient(135deg, #7C3AED, #8B5CF6);
        }

        .listing-card[data-category="Stationery"] .listing-card-image:not(:has(img))::before {
            content: '‚úèÔ∏è';
            position: absolute;
            font-size: 4rem;
            opacity: 0.4;
            z-index: 0;
        }

        .listing-card-content {
            position: relative;
            z-index: 1;
            padding: var(--space-5);
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            background: var(--bg-primary);
        }

        .listing-card-title {
            font-size: 1.0625rem;
            font-weight: 700;
            margin-bottom: var(--space-2);
            color: var(--gray-900);
            line-height: 1.3;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .listing-card-price {
            font-size: 1.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary-600), var(--accent-600));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: var(--space-2);
            letter-spacing: -0.02em;
        }

        .listing-card-location {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: var(--space-3);
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .listing-card-location::before {
            content: "üìç";
            font-size: 1rem;
        }

        .listing-card-action {
            margin-top: auto;
        }

        .listing-card-action .btn-primary {
            width: 100%;
            padding: var(--space-3) var(--space-4);
            font-size: 0.9375rem;
        }

        /* ===================================
    AVAILABILITY BADGES - PRODUCTION READY
    =================================== */

        .availability-badge {
            position: absolute;
            top: var(--space-3);
            left: var(--space-3);
            padding: var(--space-2) var(--space-3);
            border-radius: var(--radius-lg);
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            z-index: 10;
            display: flex;
            align-items: center;
            gap: var(--space-1);
            box-shadow: var(--shadow-md);
        }

        .availability-badge.available {
            background: linear-gradient(135deg, var(--success-500), var(--success-600));
            color: white;
        }

        .availability-badge.available::before {
            content: '‚óè';
            font-size: 0.625rem;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        .availability-badge.sold {
            background: linear-gradient(135deg, var(--gray-400), var(--gray-500));
            color: white;
        }

        .availability-badge.sold::before {
            content: '‚úï';
            font-size: 0.75rem;
        }

        .availability-badge.reserved {
            background: linear-gradient(135deg, var(--warning-500), #F97316);
            color: white;
        }

        .availability-badge.reserved::before {
            content: '‚è≥';
            font-size: 0.75rem;
        }

        /* SOLD ITEM STYLING */
        .listing-card.sold-out {
            opacity: 0.7;
            cursor: not-allowed;
        }

        .listing-card.sold-out::before {
            opacity: 0.03;
        }

        .listing-card.sold-out .listing-card-image {
            filter: grayscale(30%);
        }

        .listing-card.sold-out .listing-card-price {
            text-decoration: line-through;
            opacity: 0.6;
        }

        .listing-card.sold-out .btn-primary {
            background: var(--gray-400);
            cursor: not-allowed;
            pointer-events: none;
        }

        .listing-card.sold-out:hover {
            transform: translateY(-4px) scale(1.01);
            box-shadow: var(--shadow-lg);
        }

        /* VISUALLY RICH EMPTY STATE */
        .no-listings-message {
            grid-column: 1 / -1;
            text-align: center;
            margin-top: var(--space-16);
            padding: var(--space-16) var(--space-8);
            background: linear-gradient(135deg,
                    rgba(99, 102, 241, 0.05),
                    rgba(236, 72, 153, 0.05));
            border-radius: var(--radius-2xl);
            border: 2px dashed var(--primary-200);
            position: relative;
        }

        .no-listings-message::before {
            content: 'üîç';
            display: block;
            font-size: 4rem;
            margin-bottom: var(--space-4);
            opacity: 0.6;
        }

        .no-listings-message::after {
            content: 'No items found matching your filters';
            display: block;
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-top: var(--space-2);
        }

        /* ===================================
    FOOTER - RICH & ATMOSPHERIC
    =================================== */

        .footer {
            margin-top: var(--space-20);
            padding: var(--space-16) 0 var(--space-8) 0;
            background: linear-gradient(135deg,
                    #2d1b4e 0%,
                    #1a1a2e 50%,
                    #2d1b4e 100%);
            color: var(--gray-300);
            position: relative;
            overflow: hidden;
        }

        /* ATMOSPHERIC OVERLAY ON FOOTER */
        .footer::before {
            content: '';
            position: absolute;
            inset: 0;
            background-image:
                radial-gradient(circle at 20% 20%, rgba(99, 102, 241, 0.1) 0%, transparent 40%),
                radial-gradient(circle at 80% 80%, rgba(236, 72, 153, 0.08) 0%, transparent 40%);
            pointer-events: none;
        }

        .footer * {
            position: relative;
            z-index: 1;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: var(--space-6);
            margin-bottom: var(--space-6);
            flex-wrap: wrap;
        }

        .footer-links a {
            color: var(--gray-300);
            text-decoration: none;
            font-size: 0.9375rem;
            transition: all 0.3s ease;
            font-weight: 500;
            padding: var(--space-2) var(--space-3);
            border-radius: var(--radius-lg);
        }

        .footer-links a:hover {
            color: white;
            background: rgba(99, 102, 241, 0.2);
            transform: translateY(-2px);
        }

        .footer p {
            text-align: center;
            color: var(--gray-500);
            font-size: 0.875rem;
        }

        /* ===================================
    MODAL SYSTEM - DRAMATIC GLASSMORPHISM
    =================================== */

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(236, 72, 153, 0.2));
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            animation: fadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modal-content {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.98), rgba(255, 255, 255, 0.95));
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            margin: 10vh auto;
            padding: 0;
            border: 2px solid rgba(255, 255, 255, 0.5);
            border-radius: var(--radius-2xl);
            width: 90%;
            max-width: 600px;
            position: relative;
            animation: slideInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
            box-shadow: var(--shadow-2xl), 0 0 0 1px rgba(99, 102, 241, 0.1);
        }

        .modal-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-600), var(--accent-600));
        }

        .modal-content-small {
            max-width: 500px;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes slideInUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
            }

            to {
                opacity: 0;
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-6) var(--space-8);
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.05), rgba(236, 72, 153, 0.05));
            border-bottom: 2px solid var(--gray-100);
        }

        .modal-header h2 {
            background: linear-gradient(135deg, var(--primary-700), var(--accent-600));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 1.5rem;
            font-weight: 800;
            letter-spacing: -0.02em;
        }

        .modal-body {
            padding: var(--space-8);
            max-height: 60vh;
            overflow-y: auto;
        }

        /* Custom scrollbar for modal */
        .modal-body::-webkit-scrollbar {
            width: 8px;
        }

        .modal-body::-webkit-scrollbar-track {
            background: var(--gray-100);
            border-radius: var(--radius-full);
        }

        .modal-body::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--primary-500), var(--accent-500));
            border-radius: var(--radius-full);
        }

        .modal-close-btn {
            color: var(--text-tertiary);
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
            transition: all 0.3s ease;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-full);
        }

        .modal-close-btn:hover {
            color: var(--error-500);
            background: var(--gray-100);
            transform: rotate(90deg);
        }

        /* ===================================
    AUTH TAB SYSTEM - BOLD & MODERN
    =================================== */

        .auth-tabs {
            display: flex;
        }

        .auth-tab {
            width: 50%;
            padding: var(--space-5);
            text-align: center;
            font-weight: 700;
            cursor: pointer;
            background: var(--gray-50);
            color: var(--text-tertiary);
            border-bottom: 4px solid transparent;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 1rem;
        }

        .auth-tab:hover {
            background: var(--gray-100);
            color: var(--text-secondary);
        }

        .auth-tab.active {
            color: var(--primary-700);
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.08), rgba(236, 72, 153, 0.08));
            border-bottom-color: var(--primary-600);
            position: relative;
        }

        .auth-tab.active::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 50%;
            transform: translateX(-50%);
            width: 40%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-600), var(--accent-600));
            border-radius: var(--radius-full) var(--radius-full) 0 0;
        }

        .auth-form-container {
            display: none;
        }

        .auth-form-container.active {
            display: block;
            animation: fadeInScale 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.95);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* ===================================
    FORM STYLES - PREMIUM & POLISHED
    =================================== */

        .form-group {
            margin-bottom: var(--space-5);
        }

        .form-group label {
            display: block;
            margin-bottom: var(--space-2);
            font-weight: 600;
            color: var(--gray-900);
            font-size: 0.9375rem;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: var(--space-4);
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-lg);
            font-size: 1rem;
            font-family: inherit;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: var(--bg-primary);
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary-500);
            box-shadow: 0 0 0 4px var(--primary-50), 0 4px 12px rgba(99, 102, 241, 0.2);
            transform: translateY(-2px);
        }

        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        .form-error {
            color: var(--error-500);
            font-size: 0.9375rem;
            margin-top: var(--space-4);
            text-align: center;
            display: none;
            padding: var(--space-3);
            background: rgba(239, 68, 68, 0.1);
            border-radius: var(--radius-lg);
            border-left: 4px solid var(--error-500);
        }

        /* ===================================
    CHAT MODAL - MODERN MESSAGING
    =================================== */

        #chat-window {
            height: 350px;
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-xl);
            margin-bottom: var(--space-5);
            padding: var(--space-5);
            overflow-y: auto;
            background: linear-gradient(135deg, var(--gray-50), var(--bg-secondary));
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
        }

        .msg {
            padding: var(--space-3) var(--space-4);
            border-radius: var(--radius-xl);
            margin-bottom: var(--space-2);
            max-width: 75%;
            line-height: 1.5;
            animation: messageSlide 0.3s ease;
            box-shadow: var(--shadow-sm);
        }

        @keyframes messageSlide {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .msg-seller {
            background: linear-gradient(135deg, var(--gray-100), var(--gray-200));
            border-radius: var(--radius-xl) var(--radius-xl) var(--radius-xl) 0;
            align-self: flex-start;
            color: var(--gray-900);
        }

        .msg-buyer {
            background: linear-gradient(135deg, var(--primary-500), var(--accent-500));
            border-radius: var(--radius-xl) var(--radius-xl) 0 var(--radius-xl);
            align-self: flex-end;
            color: white;
            font-weight: 500;
        }

        #chat-form {
            display: flex;
            gap: var(--space-3);
        }

        #chat-form input {
            flex-grow: 1;
        }

        /* ===================================
    DETAIL MODAL - RICH PRESENTATION
    =================================== */

        #detail-modal-image {
            width: 100%;
            height: 400px;
            background: linear-gradient(135deg, var(--primary-100), var(--accent-100));
            position: relative;
            overflow: hidden;
        }

        #detail-modal-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        #detail-modal-price {
            font-size: 2.25rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--primary-600), var(--accent-600));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: var(--space-3);
            letter-spacing: -0.03em;
        }

        #detail-modal-location {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: var(--space-6);
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        #detail-modal-location::before {
            content: "üìç";
            font-size: 1.25rem;
        }

        #detail-modal-description {
            font-size: 1.0625rem;
            line-height: 1.7;
            margin-bottom: var(--space-8);
            padding-top: var(--space-6);
            border-top: 2px solid var(--gray-100);
            color: var(--text-secondary);
        }

        #detail-modal-seller-card {
            background: linear-gradient(135deg, var(--primary-50), var(--accent-50));
            border: 2px solid var(--primary-100);
            border-radius: var(--radius-xl);
            padding: var(--space-5);
            margin-bottom: var(--space-8);
            display: flex;
            align-items: center;
            gap: var(--space-4);
        }

        #detail-modal-seller-card span {
            font-weight: 700;
            color: var(--gray-900);
            font-size: 1.0625rem;
        }

        #detail-modal-actions {
            display: flex;
            gap: var(--space-4);
        }

        /* ===================================
    SAVED ITEMS MODAL
    =================================== */

        #saved-items-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--space-4);
        }

        .saved-item-card {
            display: flex;
            align-items: center;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.9));
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-xl);
            padding: var(--space-4);
            gap: var(--space-4);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .saved-item-card:hover {
            transform: translateX(8px);
            border-color: var(--primary-300);
            box-shadow: var(--shadow-lg);
        }

        .saved-item-img {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: var(--radius-lg);
            background: linear-gradient(135deg, var(--primary-100), var(--accent-100));
            box-shadow: var(--shadow-sm);
        }

        .saved-item-info {
            flex-grow: 1;
        }

        .saved-item-title {
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: var(--space-1);
        }

        .saved-item-price {
            font-size: 1.125rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary-600), var(--accent-600));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .saved-item-empty {
            text-align: center;
            color: var(--text-secondary);
            padding: var(--space-16) 0;
            font-size: 1.0625rem;
        }

        /* ===================================
    TOAST NOTIFICATIONS - BOLD FEEDBACK
    =================================== */

        #toast {
            display: none;
            position: fixed;
            bottom: var(--space-8);
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, var(--gray-900), var(--gray-800));
            color: white;
            padding: var(--space-4) var(--space-8);
            border-radius: var(--radius-full);
            z-index: 2000;
            font-size: 0.9375rem;
            font-weight: 600;
            box-shadow: var(--shadow-2xl);
            animation: toastSlideIn 0.5s cubic-bezier(0.4, 0, 0.2, 1), toastSlideOut 0.5s cubic-bezier(0.4, 0, 0.2, 1) 2.5s;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        @keyframes toastSlideIn {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        @keyframes toastSlideOut {
            from {
                opacity: 1;
            }

            to {
                opacity: 0;
            }
        }

        /* ===================================
    RESPONSIVE DESIGN - MODERN & ADAPTIVE
    =================================== */

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 260px 1fr;
                gap: var(--space-6);
            }

            .filters {
                padding: var(--space-5);
            }

            .hero h1 {
                font-size: 3rem;
            }
        }

        @media (max-width: 768px) {
            :root {
                --header-height: 64px;
            }

            .main-content {
                grid-template-columns: 1fr;
                padding: var(--space-6) 0;
            }

            /* HIDE DECORATIVE DIVIDER ON MOBILE */
            .main-content::before {
                display: none;
            }

            /* HIDE SECTION HEADER ON MOBILE FOR CLEANER LAYOUT */
            .listings-grid::before {
                font-size: 1.25rem;
                margin-bottom: var(--space-4);
            }

            .filters {
                position: static;
                margin-bottom: var(--space-6);
            }

            .header {
                padding: var(--space-3) var(--space-4);
            }

            .header-search {
                display: none;
            }

            .header-nav a,
            .header-nav button {
                padding: var(--space-2) var(--space-4);
                font-size: 0.875rem;
            }

            #welcome-msg {
                display: none;
            }

            .listings-grid {
                grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
                gap: var(--space-5);
            }

            .listing-card-image {
                height: 180px;
            }

            #detail-modal-image {
                height: 250px;
            }

            .modal-content {
                margin: 5vh auto;
                width: 95%;
            }

            .modal-header {
                padding: var(--space-5) var(--space-6);
            }

            .modal-body {
                padding: var(--space-6);
            }

            .footer {
                padding: var(--space-12) 0 var(--space-6) 0;
            }

            .footer-links {
                flex-direction: column;
                gap: var(--space-3);
            }
        }

        @media (max-width: 640px) {
            .header-logo {
                font-size: 1.25rem;
            }

            .header-logo::before {
                font-size: 1.5rem;
            }

            .container {
                padding: 0 var(--space-4);
            }

            .listings-grid {
                grid-template-columns: 1fr;
            }

            .filter-group h3 {
                font-size: 1rem;
            }

            .btn {
                padding: var(--space-2) var(--space-5);
                font-size: 0.875rem;
            }

            .modal-header h2 {
                font-size: 1.25rem;
            }

            #chat-window {
                height: 300px;
            }
        }

        /* ===================================
           SELLER INBOX STYLES
           =================================== */

        .inbox-count {
            background: var(--accent-500);
            color: white;
            border-radius: var(--radius-full);
            padding: 2px 8px;
            font-size: 0.75rem;
            font-weight: 700;
            margin-left: 4px;
        }

        .inbox-message-card {
            background: var(--bg-secondary);
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-xl);
            padding: var(--space-4);
            margin-bottom: var(--space-3);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .inbox-message-card:hover {
            border-color: var(--primary-300);
            transform: translateX(4px);
            box-shadow: var(--shadow-md);
        }

        /* Dark mode inbox */
        [data-theme="dark"] .inbox-message-card {
            background: rgba(30, 41, 59, 0.4);
            border-color: rgba(255, 255, 255, 0.1);
        }

        [data-theme="dark"] .inbox-message-card:hover {
            border-color: var(--primary-400);
            background: rgba(30, 41, 59, 0.6);
        }

        .inbox-item-info {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            margin-bottom: var(--space-2);
        }

        .inbox-item-image {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-md);
            object-fit: cover;
            border: 2px solid var(--gray-200);
        }

        .inbox-item-title {
            font-weight: 600;
            color: var(--text-primary);
        }

        .inbox-buyer-name {
            font-size: 0.875rem;
            color: var(--primary-600);
        }

        .inbox-message-preview {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: var(--space-2);
            padding-top: var(--space-2);
            border-top: 1px solid var(--gray-200);
            font-style: italic;
        }

        .inbox-timestamp {
            font-size: 0.75rem;
            color: var(--text-tertiary);
            margin-top: var(--space-2);
        }

        /* ===================================
           ENHANCED MY LISTINGS CARD STYLING
           =================================== */

        .listing-card.my-listing {
            border: 2px solid var(--primary-200);
            background: linear-gradient(135deg, var(--bg-primary), var(--primary-50));
        }

        .listing-card.my-listing::after {
            content: 'üì¶ Your Listing';
            position: absolute;
            top: var(--space-2);
            right: var(--space-2);
            background: linear-gradient(135deg, var(--primary-600), var(--accent-500));
            color: white;
            font-size: 0.7rem;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: var(--radius-full);
            z-index: 2;
        }

        [data-theme="dark"] .listing-card.my-listing {
            border-color: var(--primary-400);
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.6), rgba(99, 102, 241, 0.1));
        }

        /* ===================================
    SCROLL ENHANCEMENTS & ANIMATIONS
    =================================== */

        /* Smooth scroll behavior */
        @media (prefers-reduced-motion: no-preference) {
            html {
                scroll-behavior: smooth;
            }

            * {
                transition-property: transform, opacity, background, box-shadow, border-color;
                transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
            }
        }

        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {

            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }

        /* Loading spinner for async actions */
        .spinner {
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Page load fade-in */
        body {
            animation: pageLoad 0.6s ease-out;
        }

        @keyframes pageLoad {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }
    </style>
</head>


<body>

    <!-- ======================= HEADER ======================= -->
    <header class="header">
        <!-- Logo now links back to landing page -->
        <a href="index.html" class="header-logo">CampusBay</a>

        <div class="header-search">
            <input type="search" id="search-input" placeholder="Search for textbooks, electronics, notes...">
        </div>

        <nav class="header-nav">
            <!-- Logged Out State -->
            <div id="nav-logged-out">
                <button id="theme-toggle" class="btn btn-secondary" aria-label="Toggle dark mode"
                    style="padding: var(--space-3); width: 48px; height: 48px; border-radius: var(--radius-full); font-size: 1.25rem;"
                    title="Toggle dark mode">üåô</button>
                <button class="btn btn-primary" id="create-listing-btn-logged-out">
                    &#43; Sell Item
                </button>
                <button class="btn btn-secondary" id="login-btn">Login / Register</button>
            </div>

            <!-- Logged In State -->
            <div id="nav-logged-in">
                <button id="theme-toggle-logged-in" class="btn btn-secondary" aria-label="Toggle dark mode"
                    style="padding: var(--space-3); width: 48px; height: 48px; border-radius: var(--radius-full); font-size: 1.25rem; margin-right: 10px;"
                    title="Toggle dark mode">üåô</button>
                <span id="welcome-msg">Welcome, ABHILASH ARYA!</span>
                <button class="btn btn-secondary" id="saved-items-btn" style="margin-right: 10px;">&#9829; Saved
                    (0)</button>
                <button class="btn btn-primary" id="create-listing-btn-logged-in">
                    &#43; Sell Item
                </button>
                <button class="btn btn-secondary" id="logout-btn">Logout</button>
            </div>

        </nav>
    </header>

    <!-- ======================= MAIN CONTENT (Filters + Grid) ======================= -->
    <!-- MAIN GRID: Sidebar + Listings -->
    <div class="main-content container">
        <!-- Left Sidebar: Filters -->
        <aside class="filters">
            <!-- SELLER STATS DASHBOARD (Only visible when logged in) -->
            <div id="seller-stats"
                style="display: none; margin-bottom: var(--space-6); padding-bottom: var(--space-6); border-bottom: 2px solid rgba(255, 255, 255, 0.5);">
                <h3
                    style="font-size: 1rem; margin-bottom: var(--space-4); color: var(--gray-900); display: flex; align-items: center; gap: var(--space-2);">
                    <span>üìä</span> Your Stats
                </h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-3);">
                    <div class="stat-card"
                        style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(99, 102, 241, 0.05)); padding: var(--space-3); border-radius: var(--radius-lg); border: 1px solid rgba(99, 102, 241, 0.2);">
                        <div
                            style="font-size: 0.75rem; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.5px;">
                            Listings</div>
                        <div id="stat-total-listings"
                            style="font-size: 1.5rem; font-weight: 800; color: var(--primary-700); margin-top: var(--space-1);">
                            0</div>
                    </div>
                    <div class="stat-card"
                        style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(16, 185, 129, 0.05)); padding: var(--space-3); border-radius: var(--radius-lg); border: 1px solid rgba(16, 185, 129, 0.2);">
                        <div
                            style="font-size: 0.75rem; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.5px;">
                            Sold</div>
                        <div id="stat-sold-items"
                            style="font-size: 1.5rem; font-weight: 800; color: var(--success-600); margin-top: var(--space-1);">
                            0</div>
                    </div>
                    <div class="stat-card"
                        style="background: linear-gradient(135deg, rgba(236, 72, 153, 0.1), rgba(236, 72, 153, 0.05)); padding: var(--space-3); border-radius: var(--radius-lg); border: 1px solid rgba(236, 72, 153, 0.2); grid-column: 1 / -1;">
                        <div
                            style="font-size: 0.75rem; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.5px;">
                            Total Earnings</div>
                        <div id="stat-earnings"
                            style="font-size: 1.5rem; font-weight: 800; color: var(--accent-600); margin-top: var(--space-1);">
                            ‚Çπ0</div>
                    </div>
                </div>
            </div>

            <!-- MY LISTINGS QUICK FILTER (Only visible when logged in) -->
            <div id="my-listings-filter" style="display: none; margin-bottom: var(--space-6);">
                <button id="toggle-my-listings-btn" class="btn btn-secondary"
                    style="width: 100%; display: flex; align-items: center; justify-content: center; gap: var(--space-2); padding: var(--space-3);">
                    <span id="my-listings-icon">üì¶</span>
                    <span id="my-listings-text">Show My Listings Only</span>
                </button>
            </div>

            <!-- PURCHASE HISTORY (Only visible when logged in) -->
            <div id="purchase-history-section" style="display: none; margin-bottom: var(--space-6);">
                <button id="my-purchases-btn" class="btn btn-success"
                    style="width: 100%; display: flex; align-items: center; justify-content: center; gap: var(--space-2); padding: var(--space-3); margin-bottom: var(--space-2);">
                    <span>üõçÔ∏è</span>
                    <span>My Purchases</span>
                </button>
                <button id="my-sold-items-btn" class="btn btn-secondary"
                    style="width: 100%; display: flex; align-items: center; justify-content: center; gap: var(--space-2); padding: var(--space-3); margin-bottom: var(--space-2);">
                    <span>üí∞</span>
                    <span>My Sold Items</span>
                </button>
                <button id="seller-inbox-btn" class="btn btn-secondary"
                    style="width: 100%; display: flex; align-items: center; justify-content: center; gap: var(--space-2); padding: var(--space-3);">
                    <span>üí¨</span>
                    <span>Messages Inbox</span>
                    <span class="inbox-count" id="inbox-count" style="display: none;">0</span>
                </button>
            </div>

            <div class="filter-group">
                <h3>Categories</h3>
                <label><input type="checkbox" class="category-filter" value="Books"> Books</label>
                <label><input type="checkbox" class="category-filter" value="Electronics"> Electronics</label>
                <label><input type="checkbox" class="category-filter" value="Fashion"> Fashion</label>
                <label><input type="checkbox" class="category-filter" value="Furniture"> Furniture</label>
                <label><input type="checkbox" class="category-filter" value="Stationery"> Stationery</label>
            </div>

            <div class="filter-group">
                <h3>Price Range (&#8377;)</h3>
                <div class="price-filter">
                    <input type="number" id="price-min" placeholder="Min">
                    <input type="number" id="price-max" placeholder="Max">
                </div>
            </div>

            <div class="filter-group">
                <h3>Location</h3>
                <label>Campus:</label>
                <input type="text" placeholder="e.g., BMSCE" value="BMSCE">
                <label>Hostel / Block:</label>
                <input type="text" placeholder="e.g., CSE Block">
            </div>

        </aside>

        <!-- --- LISTINGS --- -->
        <!-- Right: Listings Grid -->
        <section class="listings-grid-section">
            <!-- Loading Overlay -->
            <div id="loading-overlay"
                style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); z-index: 9999; display: flex; align-items: center; justify-content: center;">
                <div style="text-align: center;">
                    <div class="spinner"
                        style="width: 50px; height: 50px; border: 4px solid rgba(99, 102, 241, 0.2); border-top-color: var(--primary-600); border-radius: 50%; animation: spin 0.8s linear infinite; margin: 0 auto var(--space-4);">
                    </div>
                    <div style="font-size: 1.125rem; font-weight: 600; color: var(--text-primary);">Loading amazing
                        products...</div>
                </div>
            </div>

            <div class="listings-grid" id="listings-grid">
                <!-- Listings will be dynamically inserted here -->
            </div>
        </section>

    </div><!-- End main-content -->

    <!-- ======================= FOOTER ======================= -->
    <footer class="footer">
        <div class="footer-links">
            <a href="#">About</a>
            <a href="#">Terms</a>
            <a href="#">Privacy Policy</a>
            <a href="#">How It Works</a>
            <a href="#">Safety Tips</a>
        </div>
        <p>&copy; 2025 CampusBay. Made for students, by students.</p>
    </footer>


    <!-- =================================================================== -->
    <!--                       MODALS (Hidden by default)                    -->
    <!-- =================================================================== -->

    <!-- --- Login/Register Modal (COMBINED) --- -->
    <div id="login-modal" class="modal">
        <div class="modal-content modal-content-small">

            <div class="modal-header">
                <h2 id="auth-modal-title">Login</h2> <!-- Title will change with JS -->
                <span class="modal-close-btn" data-modal-id="login">&times;</span>
            </div>

            <!-- NEW: Auth Tabs -->
            <div class="auth-tabs">
                <div class="auth-tab active" id="login-tab-btn">Login</div>
                <div class="auth-tab" id="register-tab-btn">Register</div>
            </div>

            <!-- Login Form Container -->
            <div class="auth-form-container active" id="login-form-container">
                <div class="modal-body">
                    <form id="login-form">
                        <div class="form-group">
                            <label for="email">Campus Email</label>
                            <input type="email" id="login-email" placeholder="e.g., abhilash@bmsce.ac.in" required
                                autocomplete="off">
                        </div>
                        <div class="form-group">
                            <label for="password">Password</label>
                            <input type="password" id="login-password" required autocomplete="new-password">
                        </div>
                        <button type="submit" class="btn btn-primary"
                            style="width:100%; padding: 0.75rem;">Login</button>

                        <button type="button" class="btn-demo" id="demo-login-btn">
                            &#11088; Login as Demo
                        </button>

                        <p class="form-error" id="login-error-msg">Invalid credentials. Try a demo account.</p>

                        <p style="text-align: center; margin-top: 1rem; font-size: 0.9rem;">
                            Demo accounts: <br>
                            <code
                                style="background: #eee; padding: 2px 5px; border-radius: 4px;">abhilash@bmsce.ac.in</code>
                            <br>
                            <code
                                style="background: #eee; padding: 2px 5px; border-radius: 4px;">student@rvce.ac.in</code>
                        </p>
                    </form>
                </div>
            </div>

            <!-- NEW: Register Form Container -->
            <div class="auth-form-container" id="register-form-container">
                <div class="modal-body">
                    <form id="register-form">
                        <div class="form-group">
                            <label for="register-name">Full Name</label>
                            <input type="text" id="register-name" placeholder="e.g., Priya S." required>
                        </div>
                        <div class="form-group">
                            <label for="register-email">Campus Email</label>
                            <input type="email" id="register-email" placeholder="e.g., priya@bmsce.ac.in" required>
                        </div>
                        <div class="form-group">
                            <label for="register-password">Password</label>
                            <input type="password" id="register-password" required>
                        </div>
                        <div class="form-group">
                            <label for="register-confirm-password">Confirm Password</label>
                            <input type="password" id="register-confirm-password" required>
                        </div>

                        <button type="submit" class="btn btn-primary" style="width:100%; padding: 0.75rem;">Create
                            Account</button>

                        <p class="form-error" id="register-error-msg">Passwords do not match.</p>
                    </form>
                </div>
            </div>
        </div>
    </div>


    <!-- --- Create Listing Modal --- -->
    <div id="create-listing-modal" class="modal">
        <div class="modal-content modal-content-small">
            <div class="modal-header">
                <h2>Create New Listing</h2>
                <span class="modal-close-btn" data-modal-id="create">&times;</span>
            </div>
            <div class="modal-body">
                <form id="create-listing-form">
                    <div class="form-group">
                        <label for="listing-title">Title</label>
                        <input type="text" id="listing-title" placeholder="e.g., Engineering Data Structures Textbook"
                            required>
                    </div>
                    <div class="form-group">
                        <label for="listing-price">Price (&#8377;)</label>
                        <input type="number" id="listing-price" placeholder="150" required>
                    </div>
                    <div class="form-group">
                        <label for="listing-category">Category</label>
                        <select id="listing-category" required>
                            <option value="">-- Select a category --</option>
                            <option value="Books">Books</option>
                            <option value="Electronics">Electronics</option>
                            <option value="Fashion">Fashion</option>
                            <option value="Furniture">Furniture</option>
                            <option value="Stationery">Stationery</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="listing-location">Pickup Location</label>
                        <input type="text" id="listing-location" placeholder="e.g., CSE Block, BMSCE" required>
                    </div>
                    <div class="form-group">
                        <label for="listing-description">Description</label>
                        <textarea id="listing-description"
                            placeholder="Add details: condition, edition, etc."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="images">Upload Images (Optional)</label>
                        <input type="file" id="images" multiple>
                        <small style="display:block; margin-top: 5px; color: #777;">This is for demo, images won't
                            be
                            saved.</small>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width:100%; padding: 0.75rem;">Post Your
                        Listing</button>
                </form>
            </div>
        </div>
    </div>

    <!-- --- Chat Modal --- -->
    <div id="chat-modal" class="modal">
        <div class="modal-content modal-content-small">
            <div class="modal-header">
                <h2 id="chat-modal-title">Chat with Seller</h2>
                <div style="display: flex; align-items: center; gap: var(--space-3);">
                    <button id="refresh-chat-btn" class="btn btn-secondary"
                        style="padding: var(--space-2) var(--space-3); font-size: 0.875rem;" title="Refresh messages">
                        üîÑ Refresh
                    </button>
                    <span class="modal-close-btn" data-modal-id="chat">&times;</span>
                </div>
            </div>
            <div class="modal-body">
                <div id="chat-window">
                    <div class="msg msg-seller">Hi! Is this still available?</div>
                    <div class="msg msg-buyer">Yes, it is!</div>
                </div>
                <form id="chat-form">
                    <input type="text" id="chat-message-input" placeholder="Type your message..." required>
                    <button type="submit" class="btn btn-primary">Send</button>
                </form>
            </div>
        </div>
    </div>

    <!-- --- Listing Detail Modal --- -->
    <div id="listing-detail-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="detail-modal-title">Listing Details</h2>
                <span class="modal-close-btn" data-modal-id="detail">&times;</span>
            </div>

            <div id="detail-modal-image">
                <img src="" alt="Listing Image" id="detail-modal-img-src">
            </div>

            <div class="modal-body">
                <p id="detail-modal-price">&#8377;0</p>
                <p id="detail-modal-location">Location</p>
                <p id="detail-modal-description">Full description goes here.</p>

                <div id="detail-modal-seller-card">
                    <span style="font-size: 1.5rem;">&#128100;</span>
                    <!-- Seller name will be set by JS -->
                    <span id="detail-modal-seller-name">Seller: Name</span>
                </div>

                <div id="detail-modal-actions">
                    <button class="btn btn-primary" id="detail-modal-buy-btn">üí≥ Buy Now</button>
                    <button class="btn btn-secondary" id="detail-modal-chat-btn">Message Seller</button>
                    <button class="btn btn-secondary" id="detail-modal-save-btn">Save for Later</button>

                    <!-- OWNER ACTIONS -->
                    <button class="btn btn-primary" id="detail-modal-msg-buyer-btn" style="display: none;">Message
                        Buyer</button>
                    <button class="btn btn-secondary" id="detail-modal-mark-status-btn" style="display: none;">‚úì Mark as
                        Sold</button>
                    <button class="btn btn-danger" id="detail-modal-delete-btn" style="display: none;">üóëÔ∏è Delete
                        Item</button>
                </div>
            </div>
        </div>
    </div>

    <!-- --- Saved Items Modal --- -->
    <div id="saved-items-modal" class="modal">
        <div class="modal-content modal-content-small">
            <div class="modal-header">
                <h2>Your Saved Items</h2>
                <span class="modal-close-btn" data-modal-id="saved">&times;</span>
            </div>
            <div class="modal-body">
                <div id="saved-items-grid">
                    <!-- Saved items will be injected here -->
                    <p class="saved-item-empty">You have no saved items.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- My Purchases Modal -->
    <div id="purchases-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üõçÔ∏è My Purchases</h2>
                <span class="modal-close-btn" data-modal-id="purchases">&times;</span>
            </div>
            <div class="modal-body">
                <div id="purchases-grid"
                    style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: var(--space-4);">
                    <p class="no-listings-message">You haven't purchased anything yet.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- My Sold Items Modal -->
    <div id="sold-items-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üí∞ My Sold Items</h2>
                <span class="modal-close-btn" data-modal-id="sold-items">&times;</span>
            </div>
            <div class="modal-body">
                <div id="sold-items-grid"
                    style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: var(--space-4);">
                    <p class="no-listings-message">You haven't sold anything yet.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Seller Purchase Notification Modal -->
    <div id="seller-notification-modal" class="modal">
        <div class="modal-content modal-content-small">
            <div style="text-align: center; padding: var(--space-6);">
                <div style="font-size: 4rem; margin-bottom: var(--space-3);">üéâ</div>
                <h2
                    style="font-size: 1.5rem; font-weight: 800; margin-bottom: var(--space-3); color: var(--success-600);">
                    Congratulations! Your Item Was Purchased!
                </h2>
                <div id="seller-notification-content"
                    style="text-align: left; background: var(--gray-50); padding: var(--space-5); border-radius: var(--radius-xl); margin-bottom: var(--space-4);">
                    <!-- Content will be populated by JavaScript -->
                </div>
                <button class="btn btn-primary"
                    onclick="document.getElementById('seller-notification-modal').style.display='none'; document.body.style.overflow='auto';"
                    style="width: 100%;">
                    Got it!
                </button>
            </div>
        </div>
    </div>

    <!-- Seller Messages Inbox Modal -->
    <div id="seller-inbox-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üí¨ Messages Inbox</h2>
                <span class="modal-close-btn" data-modal-id="seller-inbox">&times;</span>
            </div>
            <div class="modal-body">
                <p style="color: var(--text-secondary); margin-bottom: var(--space-4);">
                    Messages from buyers about your listed products
                </p>
                <div id="inbox-messages-container">
                    <p class="no-listings-message">No messages yet.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast">Item saved!</div>

    <!-- Payment Success Modal -->
    <div id="payment-success-modal" class="modal">
        <div class="modal-content modal-content-small">
            <div style="text-align: center; padding: var(--space-8) var(--space-6);">
                <div style="font-size: 4rem; margin-bottom: var(--space-4); animation: successPulse 0.6s ease;">
                    ‚úÖ
                </div>
                <h2
                    style="font-size: 1.75rem; font-weight: 800; margin-bottom: var(--space-3); 
                           background: linear-gradient(135deg, var(--success-600), var(--success-700));
                           -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                    Payment Successful!
                </h2>
                <p style="font-size: 1.125rem; color: var(--text-secondary); margin-bottom: var(--space-6);">
                    Your purchase has been completed
                </p>
                <div id="payment-success-details" style="background: linear-gradient(135deg, var(--success-50), var(--accent-50));
                     padding: var(--space-5); border-radius: var(--radius-xl); border: 2px solid var(--success-200);">
                </div>
                <p style="font-size: 0.875rem; color: var(--text-tertiary); margin-top: var(--space-4);">
                    The seller will contact you shortly about pickup
                </p>
            </div>
        </div>
    </div>

    <style>
        @keyframes successPulse {
            0% {
                transform: scale(0);
                opacity: 0;
            }

            50% {
                transform: scale(1.1);
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }
    </style>


    <!-- --- Payment Modal --- -->
    <div id="payment-modal" class="modal">
        <div class="modal-content modal-content-small">
            <div class="modal-header">
                <h2>üí≥ Complete Purchase</h2>
                <span class="modal-close-btn" data-modal-id="payment">&times;</span>
            </div>
            <div class="modal-body">
                <!-- Item Summary -->
                <div style="background: linear-gradient(135deg, var(--primary-50), var(--accent-50)); 
                                padding: var(--space-5); border-radius: var(--radius-xl); margin-bottom: var(--space-6);
                                border: 2px solid var(--primary-100);">
                    <h3
                        style="font-size: 1.125rem; font-weight: 700; margin-bottom: var(--space-3); color: var(--gray-900);">
                        Item Details
                    </h3>
                    <div style="display: flex; gap: var(--space-4); align-items: center;">
                        <img id="payment-item-image" src="" alt="Item"
                            style="width: 80px; height: 80px; object-fit: cover; border-radius: var(--radius-lg); box-shadow: var(--shadow-md);">
                        <div style="flex: 1;">
                            <div id="payment-item-title"
                                style="font-weight: 600; color: var(--gray-900); margin-bottom: var(--space-2);">
                            </div>
                            <div id="payment-item-price"
                                style="font-size: 1.5rem; font-weight: 800; 
                                     background: linear-gradient(135deg, var(--primary-600), var(--accent-600));
                                     -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                            </div>
                        </div>
                    </div>
                    <div
                        style="margin-top: var(--space-4); padding-top: var(--space-4); border-top: 2px solid rgba(255,255,255,0.5);">
                        <div style="font-size: 0.875rem; color: var(--text-secondary);">
                            Seller: <span id="payment-seller-name"
                                style="font-weight: 600; color: var(--gray-900);"></span>
                        </div>
                    </div>
                </div>

                <!-- Buyer Details Form -->
                <form id="payment-form">
                    <div class="form-group">
                        <label for="payment-buyer-name">Your Name</label>
                        <input type="text" id="payment-buyer-name" placeholder="Full Name" required>
                    </div>
                    <div class="form-group">
                        <label for="payment-buyer-phone">Phone Number</label>
                        <input type="tel" id="payment-buyer-phone" placeholder="10-digit mobile number"
                            pattern="[0-9]{10}" required>
                    </div>

                    <!-- Card Details Section -->
                    <div
                        style="margin-top: var(--space-5); padding-top: var(--space-5); border-top: 2px solid var(--gray-200);">
                        <h3
                            style="font-size: 1.125rem; font-weight: 700; margin-bottom: var(--space-4); color: var(--gray-900);">
                            üí≥ Card Details
                        </h3>

                        <div class="form-group">
                            <label for="payment-card-number">Card Number</label>
                            <input type="text" id="payment-card-number" placeholder="1234 5678 9012 3456" maxlength="19"
                                required>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-4);">
                            <div class="form-group">
                                <label for="payment-card-expiry">Expiry Date</label>
                                <input type="text" id="payment-card-expiry" placeholder="MM/YY" maxlength="5" required>
                            </div>
                            <div class="form-group">
                                <label for="payment-card-cvv">CVV</label>
                                <input type="password" id="payment-card-cvv" placeholder="123" maxlength="4" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="payment-card-name">Cardholder Name</label>
                            <input type="text" id="payment-card-name" placeholder="Name on card" required>
                        </div>
                    </div>

                    <div
                        style="background: var(--gray-50); padding: var(--space-4); border-radius: var(--radius-lg); margin-bottom: var(--space-5); margin-top: var(--space-4);">
                        <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: var(--space-2);">
                            üí° <strong>Demo Payment Mode</strong>
                        </div>
                        <div style="font-size: 0.8125rem; color: var(--text-secondary); line-height: 1.5;">
                            This is a demonstration. In production, this would integrate with a real payment gateway
                            (Razorpay/Stripe/PayPal). Click "Complete Purchase" to simulate a successful payment.
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary"
                        style="width: 100%; padding: var(--space-4); font-size: 1rem;">
                        üí≥ Complete Purchase
                    </button>
                </form>
            </div>
        </div>
    </div>


    <!-- 
      =======================================================================
      OLD INLINE JAVASCRIPT (COMMENTED OUT - USING app-integrated.js INSTEAD)
      =======================================================================
    -->
    <!-- <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- 0. STATE & DEMO DATA ---
            
            let isLoggedIn = false;
            let savedItems = new Set(); 
            
            const demoUsers = [
                { email: 'abhilash@bmsce.ac.in', name: 'ABHILASH ARYA' },
                { email: 'student@rvce.ac.in', name: 'Priya S.' },
                { email: 'test@pes.edu', name: 'Vikram Singh' }
            ];

            const listingsData = [
                {
                    id: 1,
                    title: "Engineering Data Structures Textbook (Used)",
                    price: 350,
                    category: "Books",
                    location: "CSE Block, BMSCE",
                    image: "https://engineeringbookstore.in/wp-content/uploads/2022/09/data-structure1-new.jpg",
                    description: "Data Structures and Algorithms textbook, 3rd Edition. Used for one semester. Some highlighting in chapters 2-5. No torn pages. Perfect for 2nd year CSE students.",
                    seller: "Rohan Gupta"
                },
                {
                    id: 2,
                    title: "boAt Rockerz 450 Headphones",
                    price: 800,
                    category: "Electronics",
                    location: "NGH 2",
                    image: "https://images.unsplash.com/photo-1739764574592-1dcd5d978a53?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&q=80&w=942",
                    description: "1-year-old boAt Rockerz 450 wireless headphones. Good battery life, lasts for 8-10 hours. Earcup foam is slightly worn but perfectly usable. Comes with charging cable.",
                    seller: "Priya S."
                },
                {
                    id: 3,
                    title: "Men's Kurta (Medium, Like New)",
                    price: 500,
                    category: "Fashion",
                    location: "Himalaya Block",
                    image: "https://koranm.com/cdn/shop/articles/Exploring_Different_Types_of_Men_s_Kurta_Designs_and_How_to_Choose_the_Best_One.png?v=1712751935&width=1440",
                    description: "Cotton-silk blend kurta, size Medium. Worn only once for a college function. Dry-cleaned and in perfect, like-new condition. Bright blue color.",
                    seller: "Aman Sharma"
                },
                {
                    id: 4,
                    title: "SG Cricket Bat (Full Size)",
                    price: 1200,
                    category: "Stationery", 
                    location: "4th Cross Road, Jaynagar",
                    image: "https://plus.unsplash.com/premium_photo-1679690884082-eaba9eccdcb5?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&q=80&w=784",
                    description: "SG Kashmir Willow cricket bat, full size (Short Handle). Used for one season of inter-hostel matches. Already knocked-in. Good for beginners and practice.",
                    seller: "Vikram Singh"
                },
                {
                    id: 5,
                    title: "Drafter / Mini-Drafter for Engineering",
                    price: 250,
                    category: "Stationery",
                    location: "Stationery Shop",
                    image: "https://m.media-amazon.com/images/I/81NWB9RoGuL.jpg",
                    description: "Standard mini-drafter for engineering drawing. Includes case and all original screws. No cracks or breaks. Works perfectly.",
                    seller: "Deepthi Arya"
                },
                {
                    id: 6,
                    title: "Study Table (Foldable)",
                    price: 600,
                    category: "Furniture",
                    location: "NGH 3 (Block 2)", 
                    image: "https://m.media-amazon.com/images/I/61Kia5ppDML._AC_UF894,1000_QL80_.jpg",
                    description: "Wooden top foldable study table. Perfect for small hostel rooms. Folds flat for easy storage under the bed. Minor scratches on the surface, but very sturdy.",
                    seller: "Riya Mehta"
                },
                {
                    id: 7,
                    title: "PS4 DualShock 4 Controller",
                    price: 5000,
                    category: "Electronics",
                    location: "NBH 7 (Block 1)", 
                    image: "https://m.media-amazon.com/images/I/71x2s-+HtPL.jpg",
                    description: "Original Sony PS4 controller. Black color. All buttons and analog sticks work perfectly. No stick drift. Selling because I upgraded to a PS5. Fixed price, no negotiation.",
                    seller: "Karan Verma"
                },
                {
                    id: 8,
                    title: "Calculus by Hari Kishan (11th Ed)",
                    price: 400,
                    category: "Books",
                    location: "Library",
                    image: "https://www.madrasshoppe.com/152328-large_default/calculus-hari-kishan.jpg",
                    description: "The classic Calculus textbook for 1st year engineering. 11th Edition. Good condition, no notes inside. Original price was 800+.",
                    seller: "Riya S."
                },
                {
                    id: 9,
                    title: "Backpack for Girls (25L)",
                    price: 750,
                    category: "Fashion",
                    location: "NGH 3 (New Girls Hostel)",
                    image: "https://images-cdn.ubuy.co.in/64b247adb5f4bf37692783ca-kebi-kids-backpack-for-girls-school.jpg",
                    description: "25L Wildcraft backpack in grey and orange. Has 3 compartments and a laptop sleeve. Zips are all working. Good for carrying books and laptop.",
                    seller: "Sneha Reddy"
                },
                 {
                    id: 10,
                    title: "HP Laptop Charger (65W)",
                    price: 900,
                    category: "Electronics",
                    location: "CSE Block, BMSCE",
                    image: "https://m.media-amazon.com/images/I/615N4L445SL._AC_UF1000,1000_QL80_.jpg",
                    description: "Original 65W HP laptop charger (blue pin). Bought a new laptop, so selling this spare one. Works perfectly. Please check your laptop's pin type before buying.",
                    seller: "Vikram Singh"
                }, 
                 {
                    id: 11,
                    title: "Set of 12 Classmate Notebooks",
                    price: 200,
                    category: "Stationery",
                    location: "Stationery Shop",
                    image: "https://static.wixstatic.com/media/e01753_85ddcd76ea3345fd927f3e5764f9f48c~mv2.png/v1/fill/w_476,h_476,al_c,lg_1,q_85,enc_avif,quality_auto/e01753_85ddcd76ea3345fd927f3e5764f9f48c~mv2.png",
                    description: "A full set of 12 brand new, un-used Classmate notebooks (180 pages, single line). Bought extra by mistake. Selling as a full set only.",
                    seller: "Rohan Gupta"
                },
                {
                    id: 12,
                    title: "Gaming Chair (Good Condition)",
                    price: 5600,
                    category: "Furniture",
                    location: "NBH 14 (Near Main Building)",
                    image: "https://th.bing.com/th/id/OIP.Gjb4GlNjv-55Jw56ohvblgHaHa?w=208&h=207&c=7&r=0&o=7&dpr=1.3&pid=1.7&rm=3",
                    description: "Black office chair with mesh back and adjustable height. Hydraulic lift works fine. Very comfortable for long study sessions. No tears in the seat.",
                    seller: "Kshitiz Mittal"
                }
            ];

            const listingsGrid = document.getElementById('listings-grid');
            const toast = document.getElementById('toast'); 
            
            // --- 1. RENDER FUNCTION ---
            function renderListings(listings) {
                listingsGrid.innerHTML = '';
                if (listings.length === 0) {
                    listingsGrid.innerHTML = '<p class="no-listings-message">No listings found matching your criteria. Try adjusting your filters!</p>';
                    return;
                }
                listings.forEach(listing => {
                    const card = `
                        <article class="listing-card" data-listing-id="${listing.id}">
                            <div class="listing-card-image">
                                <img src="${listing.image.replace('600x400', '400x300')}" alt="${listing.title}" loading="lazy" onerror="this.parentElement.innerHTML = 'Image for ${listing.title}';">
                            </div>
                            <div class="listing-card-content">
                                <h3 class="listing-card-title">${listing.title}</h3>
                                <p class="listing-card-price">&#8377;${listing.price}</p>
                                <p class="listing-card-location">${listing.location}</p>
                                <div class="listing-card-action">
                                    <button class="btn btn-primary chat-btn">Message Seller</button>
                                </div>
                            </div>
                        </article>
                    `;
                    listingsGrid.innerHTML += card;
                });
            }

            // --- 2. FILTERING LOGIC ---
            const searchInput = document.getElementById('search-input');
            const priceMinInput = document.getElementById('price-min');
            const priceMaxInput = document.getElementById('price-max');
            const categoryCheckboxes = document.querySelectorAll('.category-filter');

            function applyFilters() {
                let filteredListings = [...listingsData];
                const searchTerm = searchInput.value.toLowerCase();
                if (searchTerm) {
                    filteredListings = filteredListings.filter(l => l.title.toLowerCase().includes(searchTerm) || l.location.toLowerCase().includes(searchTerm));
                }
                const minPrice = parseFloat(priceMinInput.value);
                const maxPrice = parseFloat(priceMaxInput.value);
                if (!isNaN(minPrice)) {
                    filteredListings = filteredListings.filter(l => l.price >= minPrice);
                }
                if (!isNaN(maxPrice)) {
                    filteredListings = filteredListings.filter(l => l.price <= maxPrice);
                }
                const checkedCategories = [];
                categoryCheckboxes.forEach(cb => { if (cb.checked) checkedCategories.push(cb.value); });
                if (checkedCategories.length > 0) {
                    filteredListings = filteredListings.filter(l => checkedCategories.includes(l.category));
                }
                renderListings(filteredListings);
            }

            searchInput.addEventListener('input', applyFilters);
            priceMinInput.addEventListener('input', applyFilters);
            priceMaxInput.addEventListener('input', applyFilters);
            categoryCheckboxes.forEach(cb => cb.addEventListener('change', applyFilters));

            // --- 3. MODAL HANDLING ---
            const modals = {
                login: document.getElementById('login-modal'),
                create: document.getElementById('create-listing-modal'),
                chat: document.getElementById('chat-modal'),
                detail: document.getElementById('listing-detail-modal'),
                saved: document.getElementById('saved-items-modal')
            };
            
            const detailTitle = document.getElementById('detail-modal-title');
            const detailImg = document.getElementById('detail-modal-img-src');
            const detailPrice = document.getElementById('detail-modal-price');
            const detailLocation = document.getElementById('detail-modal-location');
            const detailDescription = document.getElementById('detail-modal-description');
            const detailSellerName = document.getElementById('detail-modal-seller-name'); 
            const detailChatBtn = document.getElementById('detail-modal-chat-btn');
            const detailSaveBtn = document.getElementById('detail-modal-save-btn'); 
            const detailBuyBtn = document.getElementById('detail-modal-buy-btn');
            const detailMsgBuyerBtn = document.getElementById('detail-modal-msg-buyer-btn');
            const detailMarkSoldBtn = document.getElementById('detail-modal-mark-status-btn');
            const detailDeleteBtn = document.getElementById('detail-modal-delete-btn');

            function showDetailModal(listingId) {
                const listing = listingsData.find(l => l.id == listingId);
                if (!listing) return;

                // 1. POPULATE DATA
                detailTitle.innerText = listing.title;
                detailImg.src = listing.image;
                detailImg.alt = listing.title;
                detailPrice.innerHTML = `&#8377;${listing.price}`;
                detailLocation.innerText = listing.location;
                detailDescription.innerText = listing.description;
                detailSellerName.innerText = `Seller: ${listing.seller}`; 
                
                // 2. CHECK OWNERSHIP
                const welcomeText = document.getElementById('welcome-msg').innerText;
                // Extract name e.g. "Welcome, Abhilash!" -> "Abhilash" (approximate)
                // Better to use a robust way if available, but relying on text as per existing patterns
                let currentUserName = "";
                if (welcomeText.includes("Welcome, ")) {
                    currentUserName = welcomeText.replace("Welcome, ", "").replace("!", "").trim(); // Remove "!"
                }

                // EXACT NAME MATCH CHECK
                const isOwner = (currentUserName === listing.seller);

                if (isOwner) {
                    // SHOW OWNER ACTIONS
                    detailBuyBtn.style.display = 'none';
                    detailChatBtn.style.display = 'none';
                    detailSaveBtn.style.display = 'none';

                    detailMsgBuyerBtn.style.display = 'inline-block';
                    detailMarkSoldBtn.style.display = 'inline-block';
                    detailDeleteBtn.style.display = 'inline-block';
                } else {
                    // SHOW BUYER ACTIONS
                    detailBuyBtn.style.display = 'inline-block';
                    detailChatBtn.style.display = 'inline-block';
                    detailSaveBtn.style.display = 'inline-block';

                    detailMsgBuyerBtn.style.display = 'none';
                    detailMarkSoldBtn.style.display = 'none';
                    detailDeleteBtn.style.display = 'none';
                }

                // Chat logic
                detailChatBtn.onclick = () => {
                    modals.detail.style.display = 'none'; 
                    showChatModal(listing.title); 
                };
                
                // Save Logic
                detailSaveBtn.dataset.listingId = listing.id;
                if (savedItems.has(listing.id)) {
                    detailSaveBtn.innerText = '‚úì Saved';
                    detailSaveBtn.classList.add('btn-success');
                    detailSaveBtn.classList.remove('btn-secondary');
                    detailSaveBtn.disabled = true;
                } else {
                    detailSaveBtn.innerText = 'Save for Later';
                    detailSaveBtn.classList.remove('btn-success');
                    detailSaveBtn.classList.add('btn-secondary');
                    detailSaveBtn.disabled = false;
                }

                modals.detail.style.display = 'block';
            }

            const chatModalTitle = document.getElementById('chat-modal-title');
            function showChatModal(title) {
                chatModalTitle.innerText = `Chat: ${title}`;
                modals.chat.style.display = 'block';
            }

            document.getElementById('login-btn').onclick = () => {
                modals.login.style.display = 'block';
            };
            document.getElementById('create-listing-btn-logged-out').onclick = () => {
                modals.login.style.display = 'block';
            };
            document.getElementById('create-listing-btn-logged-in').onclick = () => {
                modals.create.style.display = 'block';
            };

            listingsGrid.addEventListener('click', (e) => {
                const card = e.target.closest('.listing-card');
                if (!card) return; 

                const listingId = card.getAttribute('data-listing-id');

                if (e.target.classList.contains('chat-btn')) {
                    const title = card.querySelector('.listing-card-title').innerText;
                    showChatModal(title);
                } else {
                    showDetailModal(listingId);
                }
            });

            document.querySelectorAll('.modal-close-btn').forEach(btn => {
                btn.onclick = () => {
                    document.getElementById(btn.getAttribute('data-modal-id')).style.display = 'none';
                };
            });
            window.onclick = (e) => {
                if (e.target.classList.contains('modal')) e.target.style.display = 'none';
            };

            // --- 4. "CREATE LISTING" FORM ---
            const createListingForm = document.getElementById('create-listing-form');
            createListingForm.addEventListener('submit', (e) => {
                e.preventDefault();
                // Get the currently logged-in user's name
                const welcomeText = welcomeMsg.innerText.replace('Welcome, ', '').replace('!', '');
                const currentUser = demoUsers.find(user => user.name === welcomeText);
                const sellerName = currentUser ? currentUser.name : "Demo User";

                const newListing = {
                    id: listingsData.length + 1,
                    title: document.getElementById('listing-title').value,
                    price: parseFloat(document.getElementById('listing-price').value),
                    category: document.getElementById('listing-category').value,
                    location: document.getElementById('listing-location').value,
                    image: `https://placehold.co/600x400/777/FFFFFF?text=New+Item`,
                    description: document.getElementById('listing-description').value || "No description provided.",
                    seller: sellerName // Assign the logged-in user as the seller
                };
                listingsData.unshift(newListing); // Add to the beginning of the list
                applyFilters();
                modals.create.style.display = 'none';
                createListingForm.reset();
            });

            // --- 5. (Simulated) CHAT ---
            const chatForm = document.getElementById('chat-form');
            const chatInput = document.getElementById('chat-message-input');
            const chatWindow = document.getElementById('chat-window');
            chatForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const msgText = chatInput.value;
                if (!msgText.trim()) return;
                const msgDiv = document.createElement('div');
                msgDiv.classList.add('msg', 'msg-buyer');
                msgDiv.innerText = msgText;
                chatWindow.appendChild(msgDiv);
                chatWindow.scrollTop = chatWindow.scrollHeight;
                chatInput.value = '';
            });

            // --- 6. DEMO LOGIN/REGISTER LOGIC ---
            const loginForm = document.getElementById('login-form');
            const loginEmailInput = document.getElementById('login-email');
            const loginErrorMsg = document.getElementById('login-error-msg');
            const navLoggedIn = document.getElementById('nav-logged-in');
            const navLoggedOut = document.getElementById('nav-logged-out');
            const welcomeMsg = document.getElementById('welcome-msg');
            const logoutBtn = document.getElementById('logout-btn');
            const demoLoginBtn = document.getElementById('demo-login-btn'); 

            // NEW: Register Form elements
            const registerForm = document.getElementById('register-form');
            const registerNameInput = document.getElementById('register-name');
            const registerEmailInput = document.getElementById('register-email');
            const registerPasswordInput = document.getElementById('register-password');
            const registerConfirmPasswordInput = document.getElementById('register-confirm-password');
            const registerErrorMsg = document.getElementById('register-error-msg');

            // NEW: Auth Tab elements
            const loginTabBtn = document.getElementById('login-tab-btn');
            const registerTabBtn = document.getElementById('register-tab-btn');
            const loginFormContainer = document.getElementById('login-form-container');
            const registerFormContainer = document.getElementById('register-form-container');
            const authModalTitle = document.getElementById('auth-modal-title');

            loginTabBtn.addEventListener('click', () => {
                loginTabBtn.classList.add('active');
                registerTabBtn.classList.remove('active');
                loginFormContainer.classList.add('active');
                registerFormContainer.classList.remove('active');
                authModalTitle.innerText = "Login";
            });

            registerTabBtn.addEventListener('click', () => {
                loginTabBtn.classList.remove('active');
                registerTabBtn.classList.add('active');
                loginFormContainer.classList.remove('active');
                registerFormContainer.classList.add('active');
                authModalTitle.innerText = "Register";
            });

            function handleLoginSuccess(user) {
                isLoggedIn = true;
                navLoggedOut.style.display = 'none';
                navLoggedIn.style.display = 'flex';
                welcomeMsg.innerText = `Welcome, ${user.name}!`; 
                modals.login.style.display = 'none';
                loginForm.reset();
                registerForm.reset();
                loginErrorMsg.style.display = 'none';
                registerErrorMsg.style.display = 'none';
                savedItems.clear(); 
                updateSavedCount(); 
            }

            loginForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const email = loginEmailInput.value;
                const demoUser = demoUsers.find(user => user.email === email);
                if (demoUser) { handleLoginSuccess(demoUser); } 
                else { loginErrorMsg.style.display = 'block'; }
            });
            
            // NEW: Register Form Submit
            registerForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const name = registerNameInput.value;
                const email = registerEmailInput.value;
                const password = registerPasswordInput.value;
                const confirmPassword = registerConfirmPasswordInput.value;

                if (password !== confirmPassword) {
                    registerErrorMsg.innerText = "Passwords do not match.";
                    registerErrorMsg.style.display = 'block';
                    return;
                }
                
                // Check if user already exists
                if (demoUsers.find(user => user.email === email)) {
                     registerErrorMsg.innerText = "An account with this email already exists.";
                     registerErrorMsg.style.display = 'block';
                     return;
                }

                // Create and add new user
                const newUser = { email: email, name: name };
                demoUsers.push(newUser);
                
                // Automatically log in the new user
                handleLoginSuccess(newUser);
            });


            demoLoginBtn.addEventListener('click', () => {
                const firstDemoUser = demoUsers[0]; 
                handleLoginSuccess(firstDemoUser);
            });

            logoutBtn.addEventListener('click', () => {
                isLoggedIn = false;
                navLoggedOut.style.display = 'flex';
                navLoggedIn.style.display = 'none';
                savedItems.clear(); 
                updateSavedCount(); 
                // Reset any open detail modals to default state
                const allSaveBtns = document.querySelectorAll('#detail-modal-save-btn');
                allSaveBtns.forEach(btn => {
                    btn.innerText = 'Save for Later';
                    btn.classList.remove('btn-success');
                    btn.classList.add('btn-secondary');
                    btn.disabled = false;
                });
            });

            // --- 7. SAVE FOR LATER FUNCTIONALITY ---
            const savedItemsBtn = document.getElementById('saved-items-btn'); 

            function updateSavedCount() {
                savedItemsBtn.innerHTML = `&#9829; Saved (${savedItems.size})`;
            }

            function showToast(message) {
                toast.innerText = message;
                toast.style.display = 'block';
                setTimeout(() => {
                    toast.style.display = 'none';
                }, 3000); 
            }

            detailSaveBtn.addEventListener('click', () => {
                if (!isLoggedIn) {
                    modals.detail.style.display = 'none';
                    modals.login.style.display = 'block';
                    return;
                }

                const listingId = parseInt(detailSaveBtn.dataset.listingId);
                if (listingId) {
                    savedItems.add(listingId);
                    
                    detailSaveBtn.innerText = '‚úì Saved';
                    detailSaveBtn.classList.add('btn-success');
                    detailSaveBtn.classList.remove('btn-secondary');
                    detailSaveBtn.disabled = true;

                    updateSavedCount(); 
                    showToast("Item saved for later!"); 
                }
            });

            // --- 8. SAVED ITEMS MODAL LOGIC ---
            const savedItemsGrid = document.getElementById('saved-items-grid');

            function renderSavedItems() {
                if (savedItems.size === 0) {
                    savedItemsGrid.innerHTML = '<p class="saved-item-empty">You have no saved items.</p>';
                    return;
                }

                savedItemsGrid.innerHTML = ''; // Clear the grid
                
                const savedListings = listingsData.filter(listing => savedItems.has(listing.id));
                
                savedListings.forEach(listing => {
                    const itemHTML = `
                        <div class="saved-item-card" data-listing-id="${listing.id}">
                            <img src="${listing.image.replace('600x400', '100x100')}" alt="${listing.title}" class="saved-item-img">
                            <div class="saved-item-info">
                                <div class="saved-item-title">${listing.title}</div>
                                <div class="saved-item-price">&#8377;${listing.price}</div>
                            </div>
                        </div>
                    `;
                    savedItemsGrid.innerHTML += itemHTML;
                });
            }

            savedItemsBtn.addEventListener('click', () => {
                if (isLoggedIn) {
                    renderSavedItems(); // Re-render the list every time it's opened
                    modals.saved.style.display = 'block';
                }
            });
            
            savedItemsGrid.addEventListener('click', (e) => {
                const card = e.target.closest('.saved-item-card');
                if (card) {
                    const listingId = card.dataset.listingId;
                    modals.saved.style.display = 'none'; // Close saved modal
                    showDetailModal(listingId); // Show detail modal
                }
            });


            // --- Initial Render on Page Load ---
            renderListings(listingsData);

        });
    </script> -->

    <!-- Premium Scroll Effects -->
    <script>
        // Header scroll effect for enhanced glassmorphism
        window.addEventListener('scroll', () => {
            const header = document.querySelector('.header');
            if (window.scrollY > 50) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        });
    </script>

    <!-- Load Theme Manager First -->
    <script src="theme.js"></script>

    <!-- Load API Client, Then Frontend Logic -->
    <script src="api.js"></script>
    <script src="app-integrated.js"></script>

    <!-- Dark Mode Toggle Event Listeners -->
    <script>
        // Handle theme toggle for both logged out and logged in buttons
        const themeToggle = document.getElementById('theme-toggle');
        const themeToggleLoggedIn = document.getElementById('theme-toggle-logged-in');

        if (themeToggle) {
            themeToggle.addEventListener('click', () => {
                themeManager.toggle();
            });
        }

        if (themeToggleLoggedIn) {
            themeToggleLoggedIn.addEventListener('click', () => {
                themeManager.toggle();
            });
        }
    </script>
</body>

</html>